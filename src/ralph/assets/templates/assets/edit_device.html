{% extends 'assets/add_assets.html' %}

{% load bob %}

{% block form_title %}Edit device{% endblock %}

{% block additional_inputs %}
  {% for field in device_info_form %}
    <div class="control-group{% if field.errors %} error{% endif %}">
      <label class="control-label">{{ field.label }}</label>
      <div class="form-field controls">
        {{ field }}
        {% if field.errors %}
        <span class="help-inline">{% for error in field.errors %}{{ error }} {% endfor %}</span>
        {% endif %}
      </div>
    </div>
  {% endfor %}
{% endblock %}

{% block office_info_inputs %}
  {% if office_info_form %}
  <div class="span6 well">
    {% for field in office_info_form %}
      <div class="control-group{% if field.errors %} error{% endif %}">
        <label class="control-label">{{ field.label }}</label>
        <div class="form-field controls">
          {{ field }}
          {% if field.errors %}
          <span class="help-inline">{% for error in field.errors %}{{ error }} {% endfor %}</span>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
  {% endif %}
  {% if status_history %}
      <div class="span6 ">
          <h5>Status history</h5>
          <table class="table table-striped table-bordered details-history">
              <thead><tr>
                  <th>Date</th>
                  <th>Author</th>
                  <th>Before</th>
                  <th>After</th>
              </tr></thead>
              <tbody>
              {% for h in status_history %}
                  <tr>
                      <td>{{ h.date|timesince_limited }}</td>
                      <td>{{ h.user|default:'' }}</td>
                      <td>{{ h.old_value }}</td>
                      <td>{{ h.new_value }}</td>
                  </tr>
              {% endfor %}
              </tbody>
          </table>
      </div>
{% endif %}
      <div class="span6 ">
          <h5>Device parts</h5>
          {% if parts %}
          <table class="table table-striped table-bordered details-history">
              <thead><tr>
                  <th>Name</th>
                  <th>Source device</th>
                  <th>Author</th>
              </tr></thead>
              <tbody>
              {% for part in parts%}
                  <tr>
                      <td><a href="../../../edit/part/{{ part.id }}">{{ part }}</a></td>
                      <td><a href="../../../edit/device/{{ part.part_info.source_device.id }}">{{ part.part_info.source_device|default:'-'}}</a></td>
                      <td>{{ part.user|default:'-'}}</td>
                  </tr>
              {% endfor %}
              </tbody>
          </table>
          {% endif %}
          <a href='../../../add/part?device={{asset.id}}'>Add part</a>
      </div>
{% endblock %}
