#!/usr/bin/env python
# -*- coding: utf-8 -*-

DATA = '''\
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml">\n<head>\n<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />\n<meta http-equiv="Content-Script-Type" content="text/javascript" />\n<meta http-equiv="Content-Style-Type" content="text/css" />\n<meta http-equiv="Cache-control" content="private">\n<title></title>\n\n<script src="/js/prototype.js" type="text/javascript"></script>\n<script src="/js/Clarity.js" type="text/javascript"></script>\n<script language="javascript" type="text/javascript">\n \n   \tvar isSCenabled = 0;\n   \tvar isSSOenabled = 0;\n   \tvar isADEnabled = 1;\n\t\n\tfunction getAimIntProp(){\n\t\tvar sessionURI = "/session?aimGetIntProp=scl_int_enabled,pam_int_ldap_enable_mode";\n\t\tvar config = new Ajax.Request(sessionURI, { method: \'get\', onSuccess: resAimGetIntProp, onFailure: configError});\n\t}\n\tfunction resAimGetIntProp(e)\n\t{\t\n\t\n\t\tif (e.responseText == null || e.responseText.length == 0) return;\n\t\t\ttry {\n\t\t\t\tvar tempObj = e.responseText.evalJSON();\n\t\t\t\tvar _jsonData = tempObj.aimGetIntProp;\n\t\t\t\tisSCenabled = _jsonData[\'scl_int_enabled\'];\n\t\t\t\tisADEnabled = _jsonData[\'pam_int_ldap_enable_mode\'];\n\t\t\t\tgetAimBoolProp();\n\t\t\t}catch(e){\n\t\t\t\t\n\t\t\t}\n\t}\n\tfunction getAimBoolProp(){\n\t\tvar sessionURI = "/session?aimGetBoolProp=pam_bool_sso_enabled";\n\t\tvar config = new Ajax.Request(sessionURI, { method: \'get\', onSuccess: resAimGetBoolProp, onFailure: configError});\n\t}\n\tfunction resAimGetBoolProp(e)\n\t{\n\t\t\n\t\tif (e.responseText == null || e.responseText.length == 0) return;\n\t\t\ttry {\n\t\tvar tempObj = e.responseText.evalJSON();\n\t\tvar _jsonData = tempObj.aimGetBoolProp;\n\t\tisSSOenabled =  _jsonData[\'pam_bool_sso_enabled\'];\n\t\tredirect();\n\t\t}catch(e){\n\t\t\t\n\t\t\t\t\n\t\t\t}\n\t}\n\t\n\tfunction configError(e)\n\t{\n\t\t//alert("error "+e);\n\t\tredirect();\n\t}\n   \tfunction redirect() \n   \t{\n  \t\tif(isSCenabled > 0) {\n     \t\tif ( window.location.href.search(\'console\') >= 0 )\n        \t\t\ttop.document.location.href = "/sclogin.html?console";\n     \t\telse\n        \t\t\ttop.document.location.href = "/sclogin.html";\n\t\t\t} else if ((isSSOenabled == "true") && (isADEnabled == "2")) {\n \t\t\tif ( window.location.href.search(\'console\') >= 0 )\n    \t\t\t\ttop.document.location.href = "/index.html?console";\n \t\t\telse\n    \t\t\t\ttop.document.location.href = "/index.html";\n\t\t} else {\n\t\t\tif ( window.location.href.search(\'console\') >= 0 )\n\t\t\t\ttop.document.location.href = "/login.html?console";\n\t\t\telse\n\t\t\t\ttop.document.location.href = "/login.html";\n\t\t}\t\t\t\n   \t}\t\n</script>\n</head>\n<body onload="javascript:getAimIntProp();">\n</body>\n</html>\n'''
